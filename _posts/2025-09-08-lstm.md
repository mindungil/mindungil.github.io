---
title: LSTM
date: 2025-09-08 21:37:00 +0900
lastmod: 2025-09-27 14:36:00 +0900
categories: [AI, 모델]
tags: [모델, 공부, 코인, ai]
author: 길민준
---


## LSTM 이란


RNN의 그레디언트 소실 문제를 해결하기 위해 고안된 모델


이전 정보를 오랫동안 기억할 수 있는 메모리 셀을 가지고 있으며, 이를 통해 긴 시퀸수 데이터를 처리할 수 있다.


## LSTM의 구조


메모리 셀 구조 이미지


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/b8f88711-41e5-4fd4-8b5a-3a872776c24d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466UKZHLY3C%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T053740Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBUaCXVzLXdlc3QtMiJHMEUCIQCXZ%2BO6AhV40jxevxHoO5UvnjZ2CER%2F%2FNPAkv35c6ogZQIgbzKH6t49FRc6SX6mGBAxT8bUxDGkns53oGFxXFpTJnsqiAQInv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDMcnljgGrQPqTL3pGCrcAwG0cii42PSbeB%2FfBp75arp5vULgz4yqTZKaDukVNaoaZf4T49IssvgnrGiFivr6cXaY5mMcgD4PniEgbaakrQOjiTRM2cgOCW%2FILwBCTQHShkSaOPcIQdyCgdRGzxO1MQnzbo6gV7O4Iar9N3%2Fnx4X4OnBJCYlLckWqQoZPzuMW1YGCAMUJIdP8eDSa2yegkba0hAcNgC0Agk3Hd9clgWDsPnr%2FrB34GQURF1TY4KqtxEFxylZ66qf7pP5OcFU3GIVnvJE1ggR70ngaGwVbdxh%2BoWJeBfbmZdy2V1OvJSX2ol2NeHrT0qXBC%2FbXWOPPukwTJNwijBaTWoJVQ0udhxzbbVey7iU2tgNdhXJ96scnmZzuFY2FBJtxA7xTXy8pykwXMxh6RMdXzq%2BhszsR5Avhb0USjLvonuojPa1lyjaOg1cT99rSkGMcvX8QLlF0L5PQLB93crV0NOBwgfVQvhSeRMMZPGzXUsirCDTqmwcQIu%2B6MFyvAmrxspHQNrrS9EZgvhbmrydtWiwAtmEvwix%2BRGrLDGpkKxVfXpL86idmuEBWWuSUQVfyngSjkjrJYMO2Pnf2kYXIr6WjfkGY45OKLdIMOtMcDk9RuaFO4nTLQH4uv07AQ7g39g4sMLXS3cYGOqUB5obTfZwsARf6nNH1HbwO96u10XniBI7Iz8g15xYhlfRwz9DnU0WVATwiJsFzs2vpNmUVsi8Ae4YH3khx0ax3G6WOrXovt1aOqAf3LbA2JCenAiSmn1Cq3nAV0tFCFhQGN9tBfcx4U8UbD4Z%2F9xIUgHyiINyKe%2BrbX8TrC%2FJbIWcq9cHymeXoersNDIpdgCzPf8sSQNnek6FeSr2QP8c3T4GmVzKM&X-Amz-Signature=bc13131ed41ae080a34c861620cd3df34449a351a09338cf53735da0dc978a26&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


LSTM의 메모리 셀은 입력값과 이전 상태에 따라 값을 업데이트 하고, 새로운 상태를 출력


차이점: 셀의 값을 얼마나 기억할지 결정하는 것이 가능한 게이트를 가지고 있어서 필요한 정보만 기억하도록 제어 가능


상태 정보를 변경하는 게이트들: 입력 게이트, 망각 게이트, 출력 게이트, Cell state


## LSTM의 동작 원리


### Cell State (셀 상태)


이전 상태에서 현재 상태까지 유지되는 정보의 흐름 → 오래된 정보를 기억하고 새로운 정보를 적절히 갱신


망각 게이트와 입력 게이트에서 두 번의 변화


### Forget Gate (망각 게이트)


이전 셀 상태의 정보를 지울 것인지 말 것인지 결정


시그모이드 함수 특성에 따라 0~1 사이의 값을 가짐


값이 0이면 사라지고 1이면 그대로 전달


### Input Gate (입력 게이트)


새로운 정보를 어떻게 반영할 것인가 결정


탄젠트 함수(RNN 방식과 동일 연산) * 시그모이드 함수 → 셀 상태에 더해줌


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/807d9e31-f408-4bba-bd39-e8c4d6a19a36/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466UKZHLY3C%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T053740Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBUaCXVzLXdlc3QtMiJHMEUCIQCXZ%2BO6AhV40jxevxHoO5UvnjZ2CER%2F%2FNPAkv35c6ogZQIgbzKH6t49FRc6SX6mGBAxT8bUxDGkns53oGFxXFpTJnsqiAQInv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDMcnljgGrQPqTL3pGCrcAwG0cii42PSbeB%2FfBp75arp5vULgz4yqTZKaDukVNaoaZf4T49IssvgnrGiFivr6cXaY5mMcgD4PniEgbaakrQOjiTRM2cgOCW%2FILwBCTQHShkSaOPcIQdyCgdRGzxO1MQnzbo6gV7O4Iar9N3%2Fnx4X4OnBJCYlLckWqQoZPzuMW1YGCAMUJIdP8eDSa2yegkba0hAcNgC0Agk3Hd9clgWDsPnr%2FrB34GQURF1TY4KqtxEFxylZ66qf7pP5OcFU3GIVnvJE1ggR70ngaGwVbdxh%2BoWJeBfbmZdy2V1OvJSX2ol2NeHrT0qXBC%2FbXWOPPukwTJNwijBaTWoJVQ0udhxzbbVey7iU2tgNdhXJ96scnmZzuFY2FBJtxA7xTXy8pykwXMxh6RMdXzq%2BhszsR5Avhb0USjLvonuojPa1lyjaOg1cT99rSkGMcvX8QLlF0L5PQLB93crV0NOBwgfVQvhSeRMMZPGzXUsirCDTqmwcQIu%2B6MFyvAmrxspHQNrrS9EZgvhbmrydtWiwAtmEvwix%2BRGrLDGpkKxVfXpL86idmuEBWWuSUQVfyngSjkjrJYMO2Pnf2kYXIr6WjfkGY45OKLdIMOtMcDk9RuaFO4nTLQH4uv07AQ7g39g4sMLXS3cYGOqUB5obTfZwsARf6nNH1HbwO96u10XniBI7Iz8g15xYhlfRwz9DnU0WVATwiJsFzs2vpNmUVsi8Ae4YH3khx0ax3G6WOrXovt1aOqAf3LbA2JCenAiSmn1Cq3nAV0tFCFhQGN9tBfcx4U8UbD4Z%2F9xIUgHyiINyKe%2BrbX8TrC%2FJbIWcq9cHymeXoersNDIpdgCzPf8sSQNnek6FeSr2QP8c3T4GmVzKM&X-Amz-Signature=62009b780546c504d7243482c080594d98c7f541919bdfbf4bc8a2ff8c200353&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### Output Gate (출력 게이트)


출력 게이트는 셀 상태 값에 탄젠트 함수를 적용한 값을 출력으로 사용


추가적으로 출력이 얼마나 중요한지 조절 → 은닉 상태와 현재 입력에 대해 시그모이드 함수 * 출력하고자 하는 신호


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/f2a2fb13-195e-4762-a37a-be94461bc656/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466UKZHLY3C%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T053740Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBUaCXVzLXdlc3QtMiJHMEUCIQCXZ%2BO6AhV40jxevxHoO5UvnjZ2CER%2F%2FNPAkv35c6ogZQIgbzKH6t49FRc6SX6mGBAxT8bUxDGkns53oGFxXFpTJnsqiAQInv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDMcnljgGrQPqTL3pGCrcAwG0cii42PSbeB%2FfBp75arp5vULgz4yqTZKaDukVNaoaZf4T49IssvgnrGiFivr6cXaY5mMcgD4PniEgbaakrQOjiTRM2cgOCW%2FILwBCTQHShkSaOPcIQdyCgdRGzxO1MQnzbo6gV7O4Iar9N3%2Fnx4X4OnBJCYlLckWqQoZPzuMW1YGCAMUJIdP8eDSa2yegkba0hAcNgC0Agk3Hd9clgWDsPnr%2FrB34GQURF1TY4KqtxEFxylZ66qf7pP5OcFU3GIVnvJE1ggR70ngaGwVbdxh%2BoWJeBfbmZdy2V1OvJSX2ol2NeHrT0qXBC%2FbXWOPPukwTJNwijBaTWoJVQ0udhxzbbVey7iU2tgNdhXJ96scnmZzuFY2FBJtxA7xTXy8pykwXMxh6RMdXzq%2BhszsR5Avhb0USjLvonuojPa1lyjaOg1cT99rSkGMcvX8QLlF0L5PQLB93crV0NOBwgfVQvhSeRMMZPGzXUsirCDTqmwcQIu%2B6MFyvAmrxspHQNrrS9EZgvhbmrydtWiwAtmEvwix%2BRGrLDGpkKxVfXpL86idmuEBWWuSUQVfyngSjkjrJYMO2Pnf2kYXIr6WjfkGY45OKLdIMOtMcDk9RuaFO4nTLQH4uv07AQ7g39g4sMLXS3cYGOqUB5obTfZwsARf6nNH1HbwO96u10XniBI7Iz8g15xYhlfRwz9DnU0WVATwiJsFzs2vpNmUVsi8Ae4YH3khx0ax3G6WOrXovt1aOqAf3LbA2JCenAiSmn1Cq3nAV0tFCFhQGN9tBfcx4U8UbD4Z%2F9xIUgHyiINyKe%2BrbX8TrC%2FJbIWcq9cHymeXoersNDIpdgCzPf8sSQNnek6FeSr2QP8c3T4GmVzKM&X-Amz-Signature=2ab99c06f7150751807acbc1f7303182cd203cf98341a39f08e7c88fc22cea7c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


## 추가 사항

- 시계열 데이터 처리, 시퀸스 정보를 사용해 작업을 수행하는 데사용
- 장기 의존성 문제(long-term dependencies) 해결
- LSTM은 셀과 게이트로 구성
- 계산 비용이 높고 모델 구조가 복잡하다


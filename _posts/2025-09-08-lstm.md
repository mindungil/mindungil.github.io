---
title: LSTM
date: 2025-09-08 21:37:00 +0900
lastmod: 2025-09-27 14:42:00 +0900
categories: [AI, 모델]
tags: [모델, 공부, 코인, ai]
author: 길민준
---


## LSTM 이란


RNN의 그레디언트 소실 문제를 해결하기 위해 고안된 모델


이전 정보를 오랫동안 기억할 수 있는 메모리 셀을 가지고 있으며, 이를 통해 긴 시퀸스 데이터를 처리할 수 있다.


## LSTM의 구조


메모리 셀 구조 이미지


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/b8f88711-41e5-4fd4-8b5a-3a872776c24d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YJUDH4X4%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T054305Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBYaCXVzLXdlc3QtMiJHMEUCIQDFVUn5B6dzNfAA%2BIyFkYmb%2FGbsbVm36nflbeSTicqTDwIgEdkXCbF9KXoKJwL6zLxFbHzOduuHAMK2IdGUSzE29WsqiAQIn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDFEmf0XzYKIuo5PoqCrcAxlH9ArLbX3M0NLervRGvgxS8sk5zrqCIMmmb5xqRVoZVAdIlCB%2F6lgLacxMgMpYZjScy2DDmvChuK9ZrEwNfgAJEJUIxrjV2Eldmq4gErH7EQC7Xp6jPhQkK%2FzWkgEkWkTph6ElmLGVztN42VW%2BzJ4cVGtfHuFa4D5YyVNMyiV3g0G73ZqBBgv09vtZqo855eWipSfCs0%2BUXHLdWQY1TT2N1X0w%2Fg7mmyCKF4HSFiCc3MXFlQACLOzILEkvxCmodDDRvi1UeLA8oCVYqaIg3c9JALY5J%2BTrJlTsTO9mDPkcYT4TZssdE1Jf0jUQ7%2B3C9HTjVvBqeZV2ekP7ZIBuZl44%2B1hqjO%2BMG1%2Bq66xoE9xjar6%2BWUDI5MSpYECc1yDDo8Weur80Q0D48KJOZfzWHE9JV%2F66lo79ACoheqajoWjEJn3ro%2Bj7Wn%2FFxmRmnDKcNItM7o6rSlW3DLrQQ8jCUz%2BZ5AtOSYPBOBNSmjBdQiJUOglLiLOmD3%2Ba5hUzGY7MuCSjX0lHM4ccIm357gJN47dh0cSYN7%2BB3mCvh2ckEANj0xT5xkcTYbm8lgY5W2diwiWwT2rSHPaiFS1ck2UygINq47zGmS46qJnl%2BybZ73wpW0wzX73zZm09pCNrMNDx3cYGOqUB7ynsiJ%2Fbd13QtSci1mCTHbU4Ih6n%2FLhgLvpK9qATuQqd2sBh5aUHh5zY7dRORF%2BGJE%2FKvD66rHRdJJY9YGwcKO2OQ%2F6tuoaMjZIlJ9LstS5Qlql6YlGWNc308Nwfwr4pXFRCDFP5jNQxlt4xBsmwZCKeq7I%2B8KplclZSxdcjBe1XrgR%2Fr7Onciox3DUoTgSn6HA%2Bl8QbkBE27gbxoKDw2DIo0EO8&X-Amz-Signature=95ca5c6bb2024de982b891180302cfd1a55120ccbb027138f49e3f286a7be1db&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


LSTM의 메모리 셀은 입력값과 이전 상태에 따라 값을 업데이트 하고, 새로운 상태를 출력


차이점: 셀의 값을 얼마나 기억할지 결정하는 것이 가능한 게이트를 가지고 있어서 필요한 정보만 기억하도록 제어 가능


상태 정보를 변경하는 게이트들: 입력 게이트, 망각 게이트, 출력 게이트, Cell state


## LSTM의 동작 원리


### Cell State (셀 상태)


이전 상태에서 현재 상태까지 유지되는 정보의 흐름 → 오래된 정보를 기억하고 새로운 정보를 적절히 갱신


망각 게이트와 입력 게이트에서 두 번의 변화


### Forget Gate (망각 게이트)


이전 셀 상태의 정보를 지울 것인지 말 것인지 결정


시그모이드 함수 특성에 따라 0~1 사이의 값을 가짐


값이 0이면 사라지고 1이면 그대로 전달


### Input Gate (입력 게이트)


새로운 정보를 어떻게 반영할 것인가 결정


탄젠트 함수(RNN 방식과 동일 연산) * 시그모이드 함수 → 셀 상태에 더해줌


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/807d9e31-f408-4bba-bd39-e8c4d6a19a36/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YJUDH4X4%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T054305Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBYaCXVzLXdlc3QtMiJHMEUCIQDFVUn5B6dzNfAA%2BIyFkYmb%2FGbsbVm36nflbeSTicqTDwIgEdkXCbF9KXoKJwL6zLxFbHzOduuHAMK2IdGUSzE29WsqiAQIn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDFEmf0XzYKIuo5PoqCrcAxlH9ArLbX3M0NLervRGvgxS8sk5zrqCIMmmb5xqRVoZVAdIlCB%2F6lgLacxMgMpYZjScy2DDmvChuK9ZrEwNfgAJEJUIxrjV2Eldmq4gErH7EQC7Xp6jPhQkK%2FzWkgEkWkTph6ElmLGVztN42VW%2BzJ4cVGtfHuFa4D5YyVNMyiV3g0G73ZqBBgv09vtZqo855eWipSfCs0%2BUXHLdWQY1TT2N1X0w%2Fg7mmyCKF4HSFiCc3MXFlQACLOzILEkvxCmodDDRvi1UeLA8oCVYqaIg3c9JALY5J%2BTrJlTsTO9mDPkcYT4TZssdE1Jf0jUQ7%2B3C9HTjVvBqeZV2ekP7ZIBuZl44%2B1hqjO%2BMG1%2Bq66xoE9xjar6%2BWUDI5MSpYECc1yDDo8Weur80Q0D48KJOZfzWHE9JV%2F66lo79ACoheqajoWjEJn3ro%2Bj7Wn%2FFxmRmnDKcNItM7o6rSlW3DLrQQ8jCUz%2BZ5AtOSYPBOBNSmjBdQiJUOglLiLOmD3%2Ba5hUzGY7MuCSjX0lHM4ccIm357gJN47dh0cSYN7%2BB3mCvh2ckEANj0xT5xkcTYbm8lgY5W2diwiWwT2rSHPaiFS1ck2UygINq47zGmS46qJnl%2BybZ73wpW0wzX73zZm09pCNrMNDx3cYGOqUB7ynsiJ%2Fbd13QtSci1mCTHbU4Ih6n%2FLhgLvpK9qATuQqd2sBh5aUHh5zY7dRORF%2BGJE%2FKvD66rHRdJJY9YGwcKO2OQ%2F6tuoaMjZIlJ9LstS5Qlql6YlGWNc308Nwfwr4pXFRCDFP5jNQxlt4xBsmwZCKeq7I%2B8KplclZSxdcjBe1XrgR%2Fr7Onciox3DUoTgSn6HA%2Bl8QbkBE27gbxoKDw2DIo0EO8&X-Amz-Signature=683a2e1426fb491ec76bd8cbd4e152f6c045be1f0b2a37ed0699b9a254cef63d&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### Output Gate (출력 게이트)


출력 게이트는 셀 상태 값에 탄젠트 함수를 적용한 값을 출력으로 사용


추가적으로 출력이 얼마나 중요한지 조절 → 은닉 상태와 현재 입력에 대해 시그모이드 함수 * 출력하고자 하는 신호


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/f2a2fb13-195e-4762-a37a-be94461bc656/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YJUDH4X4%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T054305Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBYaCXVzLXdlc3QtMiJHMEUCIQDFVUn5B6dzNfAA%2BIyFkYmb%2FGbsbVm36nflbeSTicqTDwIgEdkXCbF9KXoKJwL6zLxFbHzOduuHAMK2IdGUSzE29WsqiAQIn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDFEmf0XzYKIuo5PoqCrcAxlH9ArLbX3M0NLervRGvgxS8sk5zrqCIMmmb5xqRVoZVAdIlCB%2F6lgLacxMgMpYZjScy2DDmvChuK9ZrEwNfgAJEJUIxrjV2Eldmq4gErH7EQC7Xp6jPhQkK%2FzWkgEkWkTph6ElmLGVztN42VW%2BzJ4cVGtfHuFa4D5YyVNMyiV3g0G73ZqBBgv09vtZqo855eWipSfCs0%2BUXHLdWQY1TT2N1X0w%2Fg7mmyCKF4HSFiCc3MXFlQACLOzILEkvxCmodDDRvi1UeLA8oCVYqaIg3c9JALY5J%2BTrJlTsTO9mDPkcYT4TZssdE1Jf0jUQ7%2B3C9HTjVvBqeZV2ekP7ZIBuZl44%2B1hqjO%2BMG1%2Bq66xoE9xjar6%2BWUDI5MSpYECc1yDDo8Weur80Q0D48KJOZfzWHE9JV%2F66lo79ACoheqajoWjEJn3ro%2Bj7Wn%2FFxmRmnDKcNItM7o6rSlW3DLrQQ8jCUz%2BZ5AtOSYPBOBNSmjBdQiJUOglLiLOmD3%2Ba5hUzGY7MuCSjX0lHM4ccIm357gJN47dh0cSYN7%2BB3mCvh2ckEANj0xT5xkcTYbm8lgY5W2diwiWwT2rSHPaiFS1ck2UygINq47zGmS46qJnl%2BybZ73wpW0wzX73zZm09pCNrMNDx3cYGOqUB7ynsiJ%2Fbd13QtSci1mCTHbU4Ih6n%2FLhgLvpK9qATuQqd2sBh5aUHh5zY7dRORF%2BGJE%2FKvD66rHRdJJY9YGwcKO2OQ%2F6tuoaMjZIlJ9LstS5Qlql6YlGWNc308Nwfwr4pXFRCDFP5jNQxlt4xBsmwZCKeq7I%2B8KplclZSxdcjBe1XrgR%2Fr7Onciox3DUoTgSn6HA%2Bl8QbkBE27gbxoKDw2DIo0EO8&X-Amz-Signature=d0fbc49a4aaa623e4740b8d73048bf6fc7e0f634664b568801fc28dfd228f644&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


## 추가 사항

- 시계열 데이터 처리, 시퀸스 정보를 사용해 작업을 수행하는 데사용
- 장기 의존성 문제(long-term dependencies) 해결
- LSTM은 셀과 게이트로 구성
- 계산 비용이 높고 모델 구조가 복잡하다


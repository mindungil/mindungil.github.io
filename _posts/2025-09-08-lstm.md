---
title: LSTM
date: 2025-09-08 21:37:00 +0900
lastmod: 2025-09-27 11:58:00 +0900
categories: [AI, 모델]
tags: [모델, 공부, 코인, ai]
---


## LSTM 이란


RNN의 그레디언트 소실 문제를 해결하기 위해 고안된 모델


이전 정보를 오랫동안 기억할 수 있는 메모리 셀을 가지고 있으며, 이를 통해 긴 시퀸수 데이터를 처리할 수 있다.


## LSTM의 구조


메모리 셀 구조 이미지


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/b8f88711-41e5-4fd4-8b5a-3a872776c24d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466ZR2ODK2T%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T025908Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBIaCXVzLXdlc3QtMiJIMEYCIQCQzStEbY%2FS5UtzFcUF3Onpzleshn6gS92o3psgpHdE3wIhAJx8HrzlzH8RNahKCq0%2Fa%2FWmjsDCgG23GAyzF06KavY4KogECJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxmpmVRn8EVG3S05ZYq3AMHMzELINC8w18SwLPnmMytCvrXH807NC2hoiemC32eDWztfvVdYkCsXdCoMgK3Wn1L27T94nPynhcd0wudBk3D3UOwplqyux42JIJ6pKvNYAv4%2BFEhxhQDO0yIg4OioMOIF%2BkDUKhbDMybVXBAwFX4zvtbgTTe69Q9uYqIgJq1XIQwS2rI44VyGElhvLzcDsuFDrI6sqb%2B12j%2Fu3NrJ1nlo56yFYu%2FIPPnKz56Lk1b9xrXS9N4ebAKUw6xabhA9bXC6osDnkEdwesEabA5B6EsV84c9hrl4HnyFKQnoOVbUTiMRu0BmtXSE5sM6SKsQczCmhRq%2F1dtUhRY3LrWopNMSfLUrZvjJ8w7ey93v6Ljk15KumO1aksuy0fhKsGNMvR0QwDhl%2FVXcTivjItxtawjrmzq1jIUJ9usV10D40Xw43gOTvWyo9biO7Vdlmq9j%2BlDHiqDln1S%2BkCr3Ra2Howj%2FW2P8LfOGybmh%2BvzGgSNtk09RXUOMEKhlhIgnp19umxPls58ilADi7%2B1ycp%2B7lnEAlagM47kacNEI2aULSkgYGh8jtcMRuy%2B7sjMBcxMvwFnwQuVxGQImwlCYXJRfHDICpEeN4QSqDXVOyi%2FLjxZh3hOfQIxjNQo3ia6ZDCth93GBjqkAXl5P5Yp5v0CmmPellydkPwj3OWKq9Hc0IczvfcgCq%2FGSLA3797mxsZaVsGyllKn6VkMe7RKTa71SvJTB7KF3ZdyvixkkKCMIiC2FqB7KlTw4DN5ndBHd6IJcz6D0EAU69ZkxXd6bdGysf3JoLLkJFhkHdK5tQOAIx4tkDw0X%2BjEx%2BvExBw4ZLCIXoixSB2RmH8iH5%2Fp2cisacBkliAgZ7l7WI3m&X-Amz-Signature=395f0d06a13d05b4f7d8cd5c57a84ba161b6ad242e30bd9085c8d0c169a15066&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


LSTM의 메모리 셀은 입력값과 이전 상태에 따라 값을 업데이트 하고, 새로운 상태를 출력


차이점: 셀의 값을 얼마나 기억할지 결정하는 것이 가능한 게이트를 가지고 있어서 필요한 정보만 기억하도록 제어 가능


상태 정보를 변경하는 게이트들: 입력 게이트, 망각 게이트, 출력 게이트, Cell state


## LSTM의 동작 원리


### Cell State (셀 상태)


이전 상태에서 현재 상태까지 유지되는 정보의 흐름 → 오래된 정보를 기억하고 새로운 정보를 적절히 갱신


망각 게이트와 입력 게이트에서 두 번의 변화


### Forget Gate (망각 게이트)


이전 셀 상태의 정보를 지울 것인지 말 것인지 결정


시그모이드 함수 특성에 따라 0~1 사이의 값을 가짐


값이 0이면 사라지고 1이면 그대로 전달


### Input Gate (입력 게이트)


새로운 정보를 어떻게 반영할 것인가 결정


탄젠트 함수(RNN 방식과 동일 연산) * 시그모이드 함수 → 셀 상태에 더해줌


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/807d9e31-f408-4bba-bd39-e8c4d6a19a36/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466ZR2ODK2T%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T025908Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBIaCXVzLXdlc3QtMiJIMEYCIQCQzStEbY%2FS5UtzFcUF3Onpzleshn6gS92o3psgpHdE3wIhAJx8HrzlzH8RNahKCq0%2Fa%2FWmjsDCgG23GAyzF06KavY4KogECJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxmpmVRn8EVG3S05ZYq3AMHMzELINC8w18SwLPnmMytCvrXH807NC2hoiemC32eDWztfvVdYkCsXdCoMgK3Wn1L27T94nPynhcd0wudBk3D3UOwplqyux42JIJ6pKvNYAv4%2BFEhxhQDO0yIg4OioMOIF%2BkDUKhbDMybVXBAwFX4zvtbgTTe69Q9uYqIgJq1XIQwS2rI44VyGElhvLzcDsuFDrI6sqb%2B12j%2Fu3NrJ1nlo56yFYu%2FIPPnKz56Lk1b9xrXS9N4ebAKUw6xabhA9bXC6osDnkEdwesEabA5B6EsV84c9hrl4HnyFKQnoOVbUTiMRu0BmtXSE5sM6SKsQczCmhRq%2F1dtUhRY3LrWopNMSfLUrZvjJ8w7ey93v6Ljk15KumO1aksuy0fhKsGNMvR0QwDhl%2FVXcTivjItxtawjrmzq1jIUJ9usV10D40Xw43gOTvWyo9biO7Vdlmq9j%2BlDHiqDln1S%2BkCr3Ra2Howj%2FW2P8LfOGybmh%2BvzGgSNtk09RXUOMEKhlhIgnp19umxPls58ilADi7%2B1ycp%2B7lnEAlagM47kacNEI2aULSkgYGh8jtcMRuy%2B7sjMBcxMvwFnwQuVxGQImwlCYXJRfHDICpEeN4QSqDXVOyi%2FLjxZh3hOfQIxjNQo3ia6ZDCth93GBjqkAXl5P5Yp5v0CmmPellydkPwj3OWKq9Hc0IczvfcgCq%2FGSLA3797mxsZaVsGyllKn6VkMe7RKTa71SvJTB7KF3ZdyvixkkKCMIiC2FqB7KlTw4DN5ndBHd6IJcz6D0EAU69ZkxXd6bdGysf3JoLLkJFhkHdK5tQOAIx4tkDw0X%2BjEx%2BvExBw4ZLCIXoixSB2RmH8iH5%2Fp2cisacBkliAgZ7l7WI3m&X-Amz-Signature=3ceb0a6969aa957af5ff08123fab2ce7b26a38f79fb2368d9d947cf9331eb02e&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### Output Gate (출력 게이트)


출력 게이트는 셀 상태 값에 탄젠트 함수를 적용한 값을 출력으로 사용


추가적으로 출력이 얼마나 중요한지 조절 → 은닉 상태와 현재 입력에 대해 시그모이드 함수 * 출력하고자 하는 신호


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/e254727a-cf7e-4706-bc8d-810dabf63a4a/f2a2fb13-195e-4762-a37a-be94461bc656/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466ZR2ODK2T%2F20250927%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250927T025908Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBIaCXVzLXdlc3QtMiJIMEYCIQCQzStEbY%2FS5UtzFcUF3Onpzleshn6gS92o3psgpHdE3wIhAJx8HrzlzH8RNahKCq0%2Fa%2FWmjsDCgG23GAyzF06KavY4KogECJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxmpmVRn8EVG3S05ZYq3AMHMzELINC8w18SwLPnmMytCvrXH807NC2hoiemC32eDWztfvVdYkCsXdCoMgK3Wn1L27T94nPynhcd0wudBk3D3UOwplqyux42JIJ6pKvNYAv4%2BFEhxhQDO0yIg4OioMOIF%2BkDUKhbDMybVXBAwFX4zvtbgTTe69Q9uYqIgJq1XIQwS2rI44VyGElhvLzcDsuFDrI6sqb%2B12j%2Fu3NrJ1nlo56yFYu%2FIPPnKz56Lk1b9xrXS9N4ebAKUw6xabhA9bXC6osDnkEdwesEabA5B6EsV84c9hrl4HnyFKQnoOVbUTiMRu0BmtXSE5sM6SKsQczCmhRq%2F1dtUhRY3LrWopNMSfLUrZvjJ8w7ey93v6Ljk15KumO1aksuy0fhKsGNMvR0QwDhl%2FVXcTivjItxtawjrmzq1jIUJ9usV10D40Xw43gOTvWyo9biO7Vdlmq9j%2BlDHiqDln1S%2BkCr3Ra2Howj%2FW2P8LfOGybmh%2BvzGgSNtk09RXUOMEKhlhIgnp19umxPls58ilADi7%2B1ycp%2B7lnEAlagM47kacNEI2aULSkgYGh8jtcMRuy%2B7sjMBcxMvwFnwQuVxGQImwlCYXJRfHDICpEeN4QSqDXVOyi%2FLjxZh3hOfQIxjNQo3ia6ZDCth93GBjqkAXl5P5Yp5v0CmmPellydkPwj3OWKq9Hc0IczvfcgCq%2FGSLA3797mxsZaVsGyllKn6VkMe7RKTa71SvJTB7KF3ZdyvixkkKCMIiC2FqB7KlTw4DN5ndBHd6IJcz6D0EAU69ZkxXd6bdGysf3JoLLkJFhkHdK5tQOAIx4tkDw0X%2BjEx%2BvExBw4ZLCIXoixSB2RmH8iH5%2Fp2cisacBkliAgZ7l7WI3m&X-Amz-Signature=55b4e7e3c511fbd5e9badb96022fab841a7f832db87ac10e62312be38a936704&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


## 추가 사항

- 시계열 데이터 처리, 시퀸스 정보를 사용해 작업을 수행하는 데사용
- 장기 의존성 문제(long-term dependencies) 해결
- LSTM은 셀과 게이트로 구성
- 계산 비용이 높고 모델 구조가 복잡하다

